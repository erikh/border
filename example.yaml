# if you load this file wholesale, here are a few commands to try:
# dig -p 5300 -t soa test.home.arpa. @localhost
# dig -p 5300 -t ns test.home.arpa. @localhost
# dig -p 5300 -t a test.home.arpa. @localhost
# dig -p 5300 -t a balancer.test.home.arpa. @localhost
listen:
  dns: :5300
# generate this key with `border keygenerate` and paste it in. This is an
# encryption and signing key. Do not use the default!
auth_key:
  alg: A256KW
  k: VbqOkBfoftuqk7_qzQse70AUScQJJGiR4JUfv-jHGIA
  kid: control
  kty: oct
# you must define at least one peer, this host will do fine for now.
# peers are transformed into load balancer and "glue" records from the
# configuration.
peers:
  - key:
      alg: A256KW
      k: VbqOkBfoftuqk7_qzQse70AUScQJJGiR4JUfv-jHGIA
      kid: foo
      kty: oct
    ips:
      - ::1
      - 127.0.0.1
    control_server: 127.0.0.1:5309
# DNS zones. Note, the records coordinate to all services border provides.
zones:
  test.home.arpa:
    soa:
      domain: test.home.arpa
      admin: administrator.test.home.arpa
      minttl: 60
      serial: 1
      refresh: 60
      retry: 1
      expire: 120
    ns:
      servers:
        - test.home.arpa
    records:
      - type: A
        name: test.home.arpa
        value:
          addresses:
            - 127.0.0.1
          healthcheck:
            - timeout: 1s
              failures: 3
      # this A record will almost certainly fail to work, which means the
      # record will be adjusted when the health check fails
      - type: A
        name: broken.test.home.arpa
        value:
          addresses:
            - 11.1.0.1
          healthcheck:
            - timeout: 1s
              failures: 3
      - type: LB
        name: balancer.test.home.arpa
        value:
          listeners:
            # note that the name 'foo' here corresponds to the peer listed
            # above, so this will listen on localhost, ipv4 and v6.
            - foo:8000
          backends:
            - 127.0.0.1:8001
            - 127.0.0.1:8002
          kind: tcp
          healthcheck:
            - timeout: 1s
              failures: 3
